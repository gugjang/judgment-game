<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>판단의 신</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
 margin:0;
 font-family:Pretendard,Arial;
 background:#f5f6fa;
 display:flex;
 justify-content:center;
 align-items:center;
 height:100vh;
}
.container{
 max-width:420px;
 width:100%;
 padding:20px;
 text-align:center;
}
h1{font-size:2.2rem}
.rule{font-size:1.2rem;font-weight:700;margin:10px 0}
.numbers{display:flex;justify-content:center;gap:10px;margin:20px 0;flex-wrap:wrap}
.num-btn{
 padding:16px 18px;
 font-size:1.4rem;
 border:none;
 border-radius:12px;
 background:#fff;
 box-shadow:0 4px 10px rgba(0,0,0,.1);
 cursor:pointer;
}
.btn{
 padding:14px 24px;
 font-size:1.2rem;
 border:none;
 border-radius:12px;
 background:#000;
 color:#fff;
 cursor:pointer;
}
.example{font-size:.9rem;color:#555;margin-top:8px}
.timer{height:8px;background:#ddd;border-radius:6px;overflow:hidden}
.fill{height:100%;background:#ff4d4d;width:100%}
.score{font-size:3rem;font-weight:800}
.q-btn{display:block;width:100%;margin:10px 0}
</style>
</head>
<body>

<div class="container" id="app"></div>

<script>
let round=0,timer;
const TIME=3000;

/* 규칙 */
const baseRules=[
 {t:"가장 큰 숫자를 고르시오",e:"12 / 25 / 18 → 25",s:n=>Math.max(...n)},
 {t:"가장 작은 숫자를 고르시오",e:"12 / 25 / 18 → 12",s:n=>Math.min(...n)},
 {t:"중간값을 고르시오",e:"12 / 18 / 25 → 18",s:n=>n.sort((a,b)=>a-b)[1]}
];

const hardRules=[
 {t:"다른 숫자들과 가장 차이가 큰 숫자를 고르시오",e:"18 / 19 / 25 → 25",s:n=>n.reduce((a,b)=>d(b,n)>d(a,n)?b:a)},
 {t:"자리수의 곱이 가장 작은 숫자를 고르시오",e:"23(6) / 41(4) / 35(15) → 41",s:n=>n.reduce((a,b)=>m(b)<m(a)?b:a)},
 {t:"보기 중 패턴을 깨는 숫자를 고르시오",e:"10 / 20 / 35 → 35",s:n=>n[n.length-1]},
 {t:"보기 중 가장 다른 숫자를 고르시오",e:"12 / 14 / 16 / 31 → 31",s:n=>n[n.length-1],four:true}
];

function m(n){return String(n).split("").reduce((a,b)=>a*b,1)}
function d(x,a){return a.reduce((s,v)=>s+Math.abs(x-v),0)}

/* 시작 */
start();

function start(){
 app.innerHTML=`
 <h1>판단의 신</h1>
 <p>시작 전 간단한 질문</p>
 <button class="btn" onclick="survey()">설문 시작</button>`;
}

/* 설문 */
function survey(){
 app.innerHTML=`
 <h1>설문조사</h1>
 <p>숫자 게임을 좋아하나요?</p>
 <button class="btn q-btn" onclick="survey2()">좋아한다</button>
 <button class="btn q-btn" onclick="survey2()">그냥 그렇다</button>`;
}
function survey2(){
 app.innerHTML=`
 <p>빠른 판단에 자신 있나요?</p>
 <button class="btn q-btn" onclick="startGame()">있다</button>
 <button class="btn q-btn" onclick="startGame()">없다</button>`;
}

/* 게임 */
function startGame(){round=0;nextRound()}

function nextRound(){
 if(round===9){transition();return;}
 round++;
 let rules = round<10?baseRules:baseRules.concat(hardRules);
 let rule=rules[Math.floor(Math.random()*rules.length)];
 let count=rule.four?4:3;
 let nums=[];
 while(nums.length<count){
  let n=Math.floor(Math.random()*90)+10;
  if(!nums.includes(n)) nums.push(n);
 }
 let ans=rule.s([...nums]);

 app.innerHTML=`
 <div class="rule">ROUND ${round}</div>
 <div class="rule">${rule.t}</div>
 <div class="numbers">
 ${nums.map(n=>`<button class="num-btn" onclick="pick(${n},${ans})">${n}</button>`).join("")}
 </div>
 <div class="timer"><div class="fill" id="fill"></div></div>
 <div class="example">${rule.e}</div>`;

 let f=document.getElementById("fill");
 f.style.transition="width 3s linear";
 setTimeout(()=>f.style.width="0%",10);
 timer=setTimeout(end,TIME);
}

function transition(){
 app.innerHTML=`
 <h1>난이도 상승</h1>
 <p>이제부터 새로운 규칙이 추가됩니다</p>
 <p>• 보기 4개 등장<br>• 계산 규칙<br>• 패턴 판단</p>
 <div class="example">예) 23 / 41 / 35 → 41</div>
 <button class="btn" onclick="nextRound()">계속하기</button>`;
}

function pick(n,a){
 clearTimeout(timer);
 n===a?nextRound():end();
}

function end(){
 app.innerHTML=`
 <h1>게임 종료</h1>
 <div class="score">${round-1}점</div>
 <p>${round<6?"연습 필요":round<11?"감각 있음":round<16?"꽤 함":"판단의 신"}</p>
 <button class="btn" onclick="start()">처음으로</button>`;
}
</script>

</body>
</html>
